@namespace FileFlow.Client.Components
@using FileFlow.Shared
@using FileFlow.Plugin;

@if (Visible && Part != null)
{
    <div class="flow-part-editor-wrapper">
        <div class="flow-part-editor-background"></div>
        <div class="flow-part-editor">

            <ViContainer Title="@Part.Type.ToString()" Icon="@Icon">

                <Head>
                    <RadzenButton class="save-button" BusyText="@lblSaving" IsBusy=@IsSaving Click=@Save Text="@lblSave" />

                    <RadzenButton class="cancel-button" Click=@Cancel Text="@lblCancel" />
                </Head>

                <Body>
                    <div class="fields">
                        @foreach (var field in Element.Fields.OrderBy(x => x.Order))
                        {
                            string label = "Flow.Parts." + Element.Name + ".Fields." + field.Name;
                            switch (field.InputType)
                            {
                                case FormInputType.Int:
                                    {
                                        var value = GetValue<int>(field.Name);
                                        <InputNumber Label="@label" Value="@value" ValueChanged="@(x => UpdateValue(field.Name, x))" />
                                    }
                                    break;
                                case FormInputType.StringArray:
                                    {
                                        var value = GetValue<string[]>(field.Name, new string[] { });
                                        <InputArray Label="@label" Value="@value" ValueChanged="@(x => UpdateValue(field.Name, x))" />
                                    }
                                    break;
                                case FormInputType.Code:
                                    {
                                        var value = GetValue<string>(field.Name);
                                        <InputCode Label="@label" Value="@value" ValueChanged="@(x => UpdateValue(field.Name, x))" />
                                    }
                                    break;
                                default:
                                    {
                                        <span>@field.InputType</span>
                                    }
                                    break;
                            }
                        }
                        <div class="empty"></div>
                    </div>
                </Body>
            </ViContainer>
        </div>

    </div>
}